{"ast":null,"code":"import { MatDialog } from '@angular/material/dialog';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatSort } from '@angular/material/sort';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { FormBuilder } from '@angular/forms';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport * as XLSX from 'xlsx';\nimport jsPDF from 'jspdf';\nimport autoTable from 'jspdf-autotable';\n// Services\nimport { TransacaoService } from '../../../../services/transacao.service';\n// Components\nimport { TransacaoCreateComponent } from '../transacao-create/transacao-create.component';\nimport { TransacaoEditComponent } from '../transacao-edit/transacao-edit.component';\nimport { TransacaoDetailComponent } from '../transacao-detail/transacao-detail.component';\nimport { TransacaoDeleteComponent } from '../transacao-delete/transacao-delete.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../services/transacao.service\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/card\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nimport * as i9 from \"@angular/material/button\";\nimport * as i10 from \"@angular/material/datepicker\";\nimport * as i11 from \"@angular/material/icon\";\nimport * as i12 from \"@angular/material/paginator\";\nimport * as i13 from \"@angular/material/menu\";\nimport * as i14 from \"@angular/material/table\";\nimport * as i15 from \"@angular/material/sort\";\nimport * as i16 from \"@angular/material/button-toggle\";\nimport * as i17 from \"../../../../components/menu/menu.component\";\nimport * as i18 from \"../../../../components/footer/footer.component\";\nconst _c0 = () => [5, 8, 10, 12, 15];\nconst _c1 = (a0, a1) => ({\n  \"positive\": a0,\n  \"negative\": a1\n});\nconst _c2 = (a0, a1) => ({\n  \"tipo-receita\": a0,\n  \"tipo-despesa\": a1\n});\nfunction TransacaoListComponent_mat_form_field_48_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-form-field\", 26)(1, \"mat-label\");\n    i0.ɵɵtext(2, \"Selecione o M\\u00EAs\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"input\", 51)(4, \"mat-datepicker-toggle\", 52);\n    i0.ɵɵelementStart(5, \"mat-datepicker\", 53, 2);\n    i0.ɵɵlistener(\"monthSelected\", function TransacaoListComponent_mat_form_field_48_Template_mat_datepicker_monthSelected_5_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const monthPicker_r3 = i0.ɵɵreference(6);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.setMonthAndYear($event, monthPicker_r3));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const monthPicker_r3 = i0.ɵɵreference(6);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"matDatepicker\", monthPicker_r3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", monthPicker_r3);\n  }\n}\nfunction TransacaoListComponent_ng_container_49_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"mat-form-field\", 26)(2, \"mat-label\");\n    i0.ɵɵtext(3, \"Data In\\u00EDcio\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 54)(5, \"mat-datepicker-toggle\", 52)(6, \"mat-datepicker\", null, 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"mat-form-field\", 26)(9, \"mat-label\");\n    i0.ɵɵtext(10, \"Data Fim\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(11, \"input\", 55)(12, \"mat-datepicker-toggle\", 52)(13, \"mat-datepicker\", null, 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 56);\n    i0.ɵɵlistener(\"click\", function TransacaoListComponent_ng_container_49_Template_button_click_15_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.aplicarFiltroData());\n    });\n    i0.ɵɵelementStart(16, \"mat-icon\");\n    i0.ɵɵtext(17, \"filter_list\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \" Aplicar \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const startPicker_r6 = i0.ɵɵreference(7);\n    const endPicker_r7 = i0.ɵɵreference(14);\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"matDatepicker\", startPicker_r6)(\"max\", ctx_r3.maxDate);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", startPicker_r6);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"matDatepicker\", endPicker_r7)(\"max\", ctx_r3.maxDate);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", endPicker_r7);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", !ctx_r3.filterForm.valid);\n  }\n}\nfunction TransacaoListComponent_mat_progress_bar_83_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 57);\n  }\n}\nfunction TransacaoListComponent_th_86_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 58);\n    i0.ɵɵtext(1, \" ID \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TransacaoListComponent_td_87_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 59);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r8 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", row_r8.transacaoID, \" \");\n  }\n}\nfunction TransacaoListComponent_th_89_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 58);\n    i0.ɵɵtext(1, \" Data \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TransacaoListComponent_td_90_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 59);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r9 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, row_r9.data, \"dd/MM/yyyy\"), \" \");\n  }\n}\nfunction TransacaoListComponent_th_92_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 58);\n    i0.ɵɵtext(1, \" Valor \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TransacaoListComponent_td_93_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 60);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r10 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(5, _c1, row_r10.tipo === \"RECEITA\", row_r10.tipo === \"DESPESA\"));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 2, row_r10.valor, \"BRL\"), \" \");\n  }\n}\nfunction TransacaoListComponent_th_95_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 58);\n    i0.ɵɵtext(1, \" Tipo \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TransacaoListComponent_td_96_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 59)(1, \"span\", 61);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const row_r11 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(2, _c2, row_r11.tipo === \"RECEITA\", row_r11.tipo === \"DESPESA\"));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", row_r11.tipo, \" \");\n  }\n}\nfunction TransacaoListComponent_th_98_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 58);\n    i0.ɵɵtext(1, \" Categoria \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TransacaoListComponent_td_99_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 59);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r12 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", row_r12.categoria.nome, \" \");\n  }\n}\nfunction TransacaoListComponent_th_101_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 58);\n    i0.ɵɵtext(1, \" Descri\\u00E7\\u00E3o \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TransacaoListComponent_td_102_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 59);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r13 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", row_r13.descricao, \" \");\n  }\n}\nfunction TransacaoListComponent_th_104_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 62);\n    i0.ɵɵtext(1, \" A\\u00E7\\u00F5es \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TransacaoListComponent_td_105_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 59)(1, \"div\", 63)(2, \"button\", 64);\n    i0.ɵɵlistener(\"click\", function TransacaoListComponent_td_105_Template_button_click_2_listener() {\n      const row_r15 = i0.ɵɵrestoreView(_r14).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.openDetailsDialog(row_r15));\n    });\n    i0.ɵɵelementStart(3, \"mat-icon\");\n    i0.ɵɵtext(4, \"visibility\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"button\", 65);\n    i0.ɵɵlistener(\"click\", function TransacaoListComponent_td_105_Template_button_click_5_listener() {\n      const row_r15 = i0.ɵɵrestoreView(_r14).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.openEditDialog(row_r15));\n    });\n    i0.ɵɵelementStart(6, \"mat-icon\");\n    i0.ɵɵtext(7, \"edit\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"button\", 66);\n    i0.ɵɵlistener(\"click\", function TransacaoListComponent_td_105_Template_button_click_8_listener() {\n      const row_r15 = i0.ɵɵrestoreView(_r14).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.openDeleteDialog(row_r15));\n    });\n    i0.ɵɵelementStart(9, \"mat-icon\");\n    i0.ɵɵtext(10, \"delete\");\n    i0.ɵɵelementEnd()()()();\n  }\n}\nfunction TransacaoListComponent_tr_106_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 67);\n  }\n}\nfunction TransacaoListComponent_tr_107_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 68);\n  }\n}\nfunction TransacaoListComponent_tr_108_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext(2);\n    const input_r16 = i0.ɵɵreference(60);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Nenhuma transa\\u00E7\\u00E3o encontrada para \\\"\", input_r16.value, \"\\\"\");\n  }\n}\nfunction TransacaoListComponent_tr_108_span_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Nenhuma transa\\u00E7\\u00E3o cadastrada\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TransacaoListComponent_tr_108_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 69)(1, \"td\", 70)(2, \"div\", 71)(3, \"mat-icon\");\n    i0.ɵɵtext(4, \"info\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, TransacaoListComponent_tr_108_span_5_Template, 2, 1, \"span\", 22)(6, TransacaoListComponent_tr_108_span_6_Template, 2, 0, \"span\", 22);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n    const input_r16 = i0.ɵɵreference(60);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", input_r16.value);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !input_r16.value);\n  }\n}\nexport let TransacaoListComponent = /*#__PURE__*/(() => {\n  class TransacaoListComponent {\n    constructor(transacaoService, dialog, snackBar, fb) {\n      this.transacaoService = transacaoService;\n      this.dialog = dialog;\n      this.snackBar = snackBar;\n      this.fb = fb;\n      // Propriedades da Tabela\n      this.displayedColumns = ['transacaoID', 'data', 'valor', 'tipo', 'descricao', 'categoria', 'acoes'];\n      // Estados\n      this.isLoading = true;\n      this.error = null;\n      this.destroy$ = new Subject();\n      // Resumo Financeiro\n      this.resumo = {\n        totalReceitas: 0,\n        totalDespesas: 0,\n        saldoTotal: 0\n      };\n      this.transacoesOriginais = [];\n      this.maxDate = new Date();\n      this.dataSource = new MatTableDataSource();\n      this.initializeFilterForm();\n    }\n    // Inicialização do formulário de filtro\n    initializeFilterForm() {\n      this.filterForm = this.fb.group({\n        tipoFiltro: ['mes'],\n        // 'mes' ou 'periodo'\n        mesAno: [new Date()],\n        // Para filtro mensal\n        dataInicio: [null],\n        // Para filtro por período\n        dataFim: [null] // Para filtro por período\n      });\n      // Observer para mudanças no tipo de filtro\n      this.filterForm.get('tipoFiltro')?.valueChanges.pipe(takeUntil(this.destroy$)).subscribe(() => {\n        this.filterForm.patchValue({\n          mesAno: new Date(),\n          dataInicio: null,\n          dataFim: null\n        });\n        this.aplicarFiltroData();\n      });\n    }\n    ngOnInit() {\n      this.loadTransacoes();\n      this.configurarDataSource();\n    }\n    ngOnDestroy() {\n      this.destroy$.next();\n      this.destroy$.complete();\n    }\n    // Configuração do DataSource com filtros personalizados\n    configurarDataSource() {\n      // Configuração do filtro de texto\n      this.dataSource.filterPredicate = (data, filter) => {\n        const searchStr = filter.toLowerCase();\n        return data.descricao.toLowerCase().includes(searchStr) || data.categoria.nome.toLowerCase().includes(searchStr) || data.tipo.toLowerCase().includes(searchStr);\n      };\n      // Configuração da ordenação\n      this.dataSource.sortingDataAccessor = (data, sortHeaderId) => {\n        switch (sortHeaderId) {\n          case 'categoria':\n            return data.categoria.nome;\n          case 'data':\n            return new Date(data.data).getTime();\n          case 'valor':\n            return data.valor;\n          case 'criadoEm':\n            return new Date(data.criadoEm).getTime();\n          default:\n            return data[sortHeaderId]?.toString() || '';\n        }\n      };\n    }\n    // Carregamento inicial das transações\n    loadTransacoes() {\n      this.isLoading = true;\n      this.transacaoService.getTransacoes().pipe(takeUntil(this.destroy$)).subscribe({\n        next: transacoes => {\n          this.transacoesOriginais = transacoes; // Mantém cópia original\n          this.dataSource.data = transacoes;\n          this.dataSource.paginator = this.paginator;\n          this.dataSource.sort = this.sort;\n          this.calcularResumoFinanceiro();\n          this.isLoading = false;\n        },\n        error: error => {\n          console.error('Erro ao carregar transações:', error);\n          this.error = error.message;\n          this.isLoading = false;\n          this.showMessage('Erro ao carregar transações', true);\n        }\n      });\n    }\n    // Método para seleção de mês no datepicker\n    setMonthAndYear(date, datepicker) {\n      const ctrlValue = this.filterForm.get('mesAno')?.value;\n      const ctrlDate = new Date(ctrlValue);\n      ctrlDate.setMonth(date.getMonth());\n      ctrlDate.setFullYear(date.getFullYear());\n      this.filterForm.get('mesAno')?.setValue(ctrlDate);\n      datepicker.close();\n      this.aplicarFiltroData();\n    }\n    // Aplicação do filtro por data\n    aplicarFiltroData() {\n      if (!this.filterForm.valid) return;\n      const formValue = this.filterForm.value;\n      let transacoesFiltradas = [...this.transacoesOriginais];\n      if (formValue.tipoFiltro === 'mes' && formValue.mesAno) {\n        // Filtro por mês específico\n        const mesAnoSelecionado = new Date(formValue.mesAno);\n        transacoesFiltradas = this.transacoesOriginais.filter(transacao => {\n          const dataTransacao = new Date(transacao.data);\n          return dataTransacao.getMonth() === mesAnoSelecionado.getMonth() && dataTransacao.getFullYear() === mesAnoSelecionado.getFullYear();\n        });\n      } else if (formValue.tipoFiltro === 'periodo' && formValue.dataInicio && formValue.dataFim) {\n        // Filtro por período\n        const inicio = new Date(formValue.dataInicio);\n        const fim = new Date(formValue.dataFim);\n        fim.setHours(23, 59, 59); // Inclui o último dia inteiro\n        transacoesFiltradas = this.transacoesOriginais.filter(transacao => {\n          const dataTransacao = new Date(transacao.data);\n          return dataTransacao >= inicio && dataTransacao <= fim;\n        });\n      }\n      // Atualiza o DataSource e recalcula o resumo\n      this.dataSource.data = transacoesFiltradas;\n      this.calcularResumoFinanceiro();\n      if (this.dataSource.paginator) {\n        this.dataSource.paginator.firstPage();\n      }\n    }\n    // Limpa os filtros de data\n    limparFiltroData() {\n      this.filterForm.patchValue({\n        tipoFiltro: 'mes',\n        mesAno: new Date(),\n        dataInicio: null,\n        dataFim: null\n      });\n      this.dataSource.data = this.transacoesOriginais;\n      this.calcularResumoFinanceiro();\n    }\n    // Cálculo do resumo financeiro\n    calcularResumoFinanceiro() {\n      if (!this.dataSource.data) return;\n      this.resumo.totalReceitas = this.dataSource.data.filter(t => t.tipo === 'Entrada').reduce((acc, curr) => acc + curr.valor, 0);\n      this.resumo.totalDespesas = this.dataSource.data.filter(t => t.tipo === 'Saida').reduce((acc, curr) => acc + curr.valor, 0);\n      this.resumo.saldoTotal = this.resumo.totalReceitas - this.resumo.totalDespesas;\n    }\n    // Filtro de texto na tabela\n    applyFilter(event) {\n      const filterValue = event.target.value;\n      this.dataSource.filter = filterValue.trim().toLowerCase();\n      if (this.dataSource.paginator) {\n        this.dataSource.paginator.firstPage();\n      }\n    }\n    // Métodos de CRUD - Diálogos\n    openCreateDialog() {\n      const dialogRef = this.dialog.open(TransacaoCreateComponent, {\n        width: '600px',\n        disableClose: true\n      });\n      dialogRef.afterClosed().pipe(takeUntil(this.destroy$)).subscribe(result => {\n        if (result) {\n          this.loadTransacoes();\n          this.showMessage('Transação criada com sucesso');\n        }\n      });\n    }\n    openEditDialog(transacao) {\n      const dialogRef = this.dialog.open(TransacaoEditComponent, {\n        width: '600px',\n        data: transacao,\n        disableClose: true\n      });\n      dialogRef.afterClosed().pipe(takeUntil(this.destroy$)).subscribe(result => {\n        if (result) {\n          this.loadTransacoes();\n          this.showMessage('Transação atualizada com sucesso');\n        }\n      });\n    }\n    openDetailsDialog(transacao) {\n      this.dialog.open(TransacaoDetailComponent, {\n        width: '600px',\n        data: transacao\n      });\n    }\n    openDeleteDialog(transacao) {\n      const dialogRef = this.dialog.open(TransacaoDeleteComponent, {\n        width: '400px',\n        data: transacao,\n        disableClose: true\n      });\n      dialogRef.afterClosed().pipe(takeUntil(this.destroy$)).subscribe(result => {\n        if (result) {\n          this.loadTransacoes();\n          this.showMessage('Transação excluída com sucesso');\n        }\n      });\n    }\n    // Métodos de Exportação\n    exportarParaExcel() {\n      const dadosExportacao = this.prepararDadosExportacao();\n      const planilha = XLSX.utils.json_to_sheet(dadosExportacao);\n      const pastaTrabalho = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(pastaTrabalho, planilha, 'Transações');\n      XLSX.writeFile(pastaTrabalho, `transacoes_${this.getDataFormatada()}.xlsx`);\n      this.showMessage('Arquivo Excel gerado com sucesso');\n    }\n    exportarParaPDF() {\n      const doc = new jsPDF();\n      const dadosExportacao = this.prepararDadosExportacao();\n      this.configurarCabecalhoPDF(doc);\n      this.adicionarTabelaPDF(doc, dadosExportacao);\n      doc.save(`transacoes_${this.getDataFormatada()}.pdf`);\n      this.showMessage('Arquivo PDF gerado com sucesso');\n    }\n    // Métodos auxiliares para exportação\n    prepararDadosExportacao() {\n      return this.dataSource.filteredData.map(linha => ({\n        'ID': linha.transacaoID,\n        'Data': new Date(linha.data).toLocaleDateString('pt-BR'),\n        'Valor': new Intl.NumberFormat('pt-BR', {\n          style: 'currency',\n          currency: 'BRL'\n        }).format(linha.valor),\n        'Tipo': linha.tipo,\n        'Categoria': linha.categoria.nome,\n        'Descrição': linha.descricao,\n        'Criado em': new Date(linha.criadoEm).toLocaleDateString('pt-BR')\n      }));\n    }\n    configurarCabecalhoPDF(doc) {\n      doc.setFontSize(16);\n      doc.text('Relatório de Transações', 14, 15);\n      doc.setFontSize(10);\n      doc.text(`Período: ${this.getDataFormatada()}`, 14, 22);\n      doc.text(`Total Receitas: ${new Intl.NumberFormat('pt-BR', {\n        style: 'currency',\n        currency: 'BRL'\n      }).format(this.resumo.totalReceitas)}`, 14, 29);\n      doc.text(`Total Despesas: ${new Intl.NumberFormat('pt-BR', {\n        style: 'currency',\n        currency: 'BRL'\n      }).format(this.resumo.totalDespesas)}`, 14, 36);\n      doc.text(`Saldo: ${new Intl.NumberFormat('pt-BR', {\n        style: 'currency',\n        currency: 'BRL'\n      }).format(this.resumo.saldoTotal)}`, 14, 43);\n    }\n    adicionarTabelaPDF(doc, dados) {\n      autoTable(doc, {\n        head: [['ID', 'Data', 'Valor', 'Tipo', 'Categoria', 'Descrição', 'Criado em']],\n        body: dados.map(Object.values),\n        startY: 50,\n        styles: {\n          fontSize: 8,\n          cellPadding: 2,\n          font: 'helvetica'\n        },\n        headStyles: {\n          fillColor: [66, 66, 66]\n        },\n        didDrawPage: data => {\n          const rodape = `Gerado em: ${new Date().toLocaleDateString('pt-BR')} ${new Date().toLocaleTimeString('pt-BR')}`;\n          doc.setFontSize(8);\n          doc.text(rodape, data.settings.margin.left, doc.internal.pageSize.height - 10);\n        }\n      });\n    }\n    // Métodos utilitários\n    getDataFormatada() {\n      return new Date().toISOString().split('T')[0];\n    }\n    showMessage(message, isError = false) {\n      this.snackBar.open(message, 'Fechar', {\n        duration: 5000,\n        panelClass: isError ? ['error-snackbar'] : ['success-snackbar'],\n        horizontalPosition: 'end',\n        verticalPosition: 'top'\n      });\n    }\n    // Método auxiliar para formatar data para exibição\n    formatarData(data) {\n      return new Date(data).toLocaleDateString('pt-BR');\n    }\n    // Método auxiliar para formatar moeda\n    formatarMoeda(valor) {\n      return new Intl.NumberFormat('pt-BR', {\n        style: 'currency',\n        currency: 'BRL'\n      }).format(valor);\n    }\n    // Método para verificar se o período selecionado é válido\n    isPeriodoValido() {\n      const inicio = this.filterForm.get('dataInicio')?.value;\n      const fim = this.filterForm.get('dataFim')?.value;\n      return inicio && fim && inicio <= fim;\n    }\n    // Método para obter o período atual do filtro como string\n    getPeriodoAtualString() {\n      const formValue = this.filterForm.value;\n      if (formValue.tipoFiltro === 'mes' && formValue.mesAno) {\n        const data = new Date(formValue.mesAno);\n        return `${data.toLocaleDateString('pt-BR', {\n          month: 'long',\n          year: 'numeric'\n        })}`;\n      } else if (formValue.tipoFiltro === 'periodo' && formValue.dataInicio && formValue.dataFim) {\n        return `${this.formatarData(formValue.dataInicio)} até ${this.formatarData(formValue.dataFim)}`;\n      }\n      return 'Período não especificado';\n    }\n    static {\n      this.ɵfac = function TransacaoListComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || TransacaoListComponent)(i0.ɵɵdirectiveInject(i1.TransacaoService), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.MatSnackBar), i0.ɵɵdirectiveInject(i4.FormBuilder));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: TransacaoListComponent,\n        selectors: [[\"app-transacao-list\"]],\n        viewQuery: function TransacaoListComponent_Query(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵviewQuery(MatPaginator, 5);\n            i0.ɵɵviewQuery(MatSort, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sort = _t.first);\n          }\n        },\n        decls: 111,\n        vars: 23,\n        consts: [[\"input\", \"\"], [\"exportMenu\", \"matMenu\"], [\"monthPicker\", \"\"], [\"startPicker\", \"\"], [\"endPicker\", \"\"], [1, \"main-content\"], [1, \"container\"], [1, \"dashboard-header\"], [1, \"summary-cards\"], [1, \"summary-card\", \"income\"], [1, \"card-icon\"], [1, \"card-info\"], [1, \"card-label\"], [1, \"card-value\"], [1, \"summary-card\", \"expense\"], [1, \"summary-card\", \"balance\"], [1, \"filter-card\"], [1, \"filter-form\", 3, \"formGroup\"], [\"formControlName\", \"tipoFiltro\", 1, \"filter-type-group\"], [\"value\", \"mes\"], [\"value\", \"periodo\"], [\"appearance\", \"outline\", 4, \"ngIf\"], [4, \"ngIf\"], [\"mat-button\", \"\", 3, \"click\"], [1, \"actions-bar\"], [1, \"search-filter\"], [\"appearance\", \"outline\"], [\"matInput\", \"\", \"placeholder\", \"Ex. dep\\u00F3sito\", 3, \"keyup\"], [\"matSuffix\", \"\"], [1, \"action-buttons-group\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"mat-stroked-button\", \"\", 3, \"matMenuTriggerFor\"], [\"mat-menu-item\", \"\", 3, \"click\"], [1, \"table-container\"], [\"mode\", \"indeterminate\", 4, \"ngIf\"], [\"mat-table\", \"\", \"matSort\", \"\", 3, \"dataSource\"], [\"matColumnDef\", \"transacaoID\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"data\"], [\"matColumnDef\", \"valor\"], [\"mat-cell\", \"\", 3, \"ngClass\", 4, \"matCellDef\"], [\"matColumnDef\", \"tipo\"], [\"matColumnDef\", \"categoria\"], [\"matColumnDef\", \"descricao\"], [\"matColumnDef\", \"acoes\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"class\", \"mat-row\", 4, \"matNoDataRow\"], [\"showFirstLastButtons\", \"\", 3, \"pageSizeOptions\", \"pageSize\"], [\"matInput\", \"\", \"formControlName\", \"mesAno\", \"readonly\", \"\", 3, \"matDatepicker\"], [\"matSuffix\", \"\", 3, \"for\"], [\"startView\", \"year\", \"panelClass\", \"month-picker\", 3, \"monthSelected\"], [\"matInput\", \"\", \"formControlName\", \"dataInicio\", 3, \"matDatepicker\", \"max\"], [\"matInput\", \"\", \"formControlName\", \"dataFim\", 3, \"matDatepicker\", \"max\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\", \"disabled\"], [\"mode\", \"indeterminate\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\"], [\"mat-cell\", \"\"], [\"mat-cell\", \"\", 3, \"ngClass\"], [3, \"ngClass\"], [\"mat-header-cell\", \"\"], [1, \"action-buttons\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", \"matTooltip\", \"Detalhes\", 3, \"click\"], [\"mat-icon-button\", \"\", \"color\", \"accent\", \"matTooltip\", \"Editar\", 3, \"click\"], [\"mat-icon-button\", \"\", \"color\", \"warn\", \"matTooltip\", \"Excluir\", 3, \"click\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"], [1, \"mat-row\"], [\"colspan\", \"7\", 1, \"mat-cell\"], [1, \"no-data\"]],\n        template: function TransacaoListComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            const _r1 = i0.ɵɵgetCurrentView();\n            i0.ɵɵelementStart(0, \"div\", 5);\n            i0.ɵɵelement(1, \"app-menu\");\n            i0.ɵɵelementStart(2, \"div\", 6)(3, \"div\", 7)(4, \"h1\");\n            i0.ɵɵtext(5, \"Transa\\u00E7\\u00F5es\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"div\", 8)(7, \"mat-card\", 9)(8, \"mat-card-content\")(9, \"div\", 10)(10, \"mat-icon\");\n            i0.ɵɵtext(11, \"arrow_upward\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(12, \"div\", 11)(13, \"span\", 12);\n            i0.ɵɵtext(14, \"Receitas\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"span\", 13);\n            i0.ɵɵtext(16);\n            i0.ɵɵpipe(17, \"currency\");\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(18, \"mat-card\", 14)(19, \"mat-card-content\")(20, \"div\", 10)(21, \"mat-icon\");\n            i0.ɵɵtext(22, \"arrow_downward\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(23, \"div\", 11)(24, \"span\", 12);\n            i0.ɵɵtext(25, \"Despesas\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(26, \"span\", 13);\n            i0.ɵɵtext(27);\n            i0.ɵɵpipe(28, \"currency\");\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(29, \"mat-card\", 15)(30, \"mat-card-content\")(31, \"div\", 10)(32, \"mat-icon\");\n            i0.ɵɵtext(33, \"account_balance\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(34, \"div\", 11)(35, \"span\", 12);\n            i0.ɵɵtext(36, \"Saldo\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(37, \"span\", 13);\n            i0.ɵɵtext(38);\n            i0.ɵɵpipe(39, \"currency\");\n            i0.ɵɵelementEnd()()()()()();\n            i0.ɵɵelementStart(40, \"mat-card\", 16)(41, \"mat-card-content\")(42, \"form\", 17)(43, \"mat-button-toggle-group\", 18)(44, \"mat-button-toggle\", 19);\n            i0.ɵɵtext(45, \"M\\u00EAs Espec\\u00EDfico\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(46, \"mat-button-toggle\", 20);\n            i0.ɵɵtext(47, \"Per\\u00EDodo\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(48, TransacaoListComponent_mat_form_field_48_Template, 7, 2, \"mat-form-field\", 21)(49, TransacaoListComponent_ng_container_49_Template, 19, 7, \"ng-container\", 22);\n            i0.ɵɵelementStart(50, \"button\", 23);\n            i0.ɵɵlistener(\"click\", function TransacaoListComponent_Template_button_click_50_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.limparFiltroData());\n            });\n            i0.ɵɵelementStart(51, \"mat-icon\");\n            i0.ɵɵtext(52, \"clear\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(53, \" Limpar \");\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(54, \"div\", 24)(55, \"div\", 25)(56, \"mat-form-field\", 26)(57, \"mat-label\");\n            i0.ɵɵtext(58, \"Filtrar\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(59, \"input\", 27, 0);\n            i0.ɵɵlistener(\"keyup\", function TransacaoListComponent_Template_input_keyup_59_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.applyFilter($event));\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(61, \"mat-icon\", 28);\n            i0.ɵɵtext(62, \"search\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(63, \"div\", 29)(64, \"button\", 30);\n            i0.ɵɵlistener(\"click\", function TransacaoListComponent_Template_button_click_64_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.openCreateDialog());\n            });\n            i0.ɵɵelementStart(65, \"mat-icon\");\n            i0.ɵɵtext(66, \"add\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(67, \" Nova Transa\\u00E7\\u00E3o \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(68, \"button\", 31)(69, \"mat-icon\");\n            i0.ɵɵtext(70, \"download\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(71, \" Exportar \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(72, \"mat-menu\", null, 1)(74, \"button\", 32);\n            i0.ɵɵlistener(\"click\", function TransacaoListComponent_Template_button_click_74_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.exportarParaExcel());\n            });\n            i0.ɵɵelementStart(75, \"mat-icon\");\n            i0.ɵɵtext(76, \"description\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(77, \" Exportar Excel \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(78, \"button\", 32);\n            i0.ɵɵlistener(\"click\", function TransacaoListComponent_Template_button_click_78_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.exportarParaPDF());\n            });\n            i0.ɵɵelementStart(79, \"mat-icon\");\n            i0.ɵɵtext(80, \"picture_as_pdf\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(81, \" Exportar PDF \");\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(82, \"mat-card\", 33);\n            i0.ɵɵtemplate(83, TransacaoListComponent_mat_progress_bar_83_Template, 1, 0, \"mat-progress-bar\", 34);\n            i0.ɵɵelementStart(84, \"table\", 35);\n            i0.ɵɵelementContainerStart(85, 36);\n            i0.ɵɵtemplate(86, TransacaoListComponent_th_86_Template, 2, 0, \"th\", 37)(87, TransacaoListComponent_td_87_Template, 2, 1, \"td\", 38);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(88, 39);\n            i0.ɵɵtemplate(89, TransacaoListComponent_th_89_Template, 2, 0, \"th\", 37)(90, TransacaoListComponent_td_90_Template, 3, 4, \"td\", 38);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(91, 40);\n            i0.ɵɵtemplate(92, TransacaoListComponent_th_92_Template, 2, 0, \"th\", 37)(93, TransacaoListComponent_td_93_Template, 3, 8, \"td\", 41);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(94, 42);\n            i0.ɵɵtemplate(95, TransacaoListComponent_th_95_Template, 2, 0, \"th\", 37)(96, TransacaoListComponent_td_96_Template, 3, 5, \"td\", 38);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(97, 43);\n            i0.ɵɵtemplate(98, TransacaoListComponent_th_98_Template, 2, 0, \"th\", 37)(99, TransacaoListComponent_td_99_Template, 2, 1, \"td\", 38);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(100, 44);\n            i0.ɵɵtemplate(101, TransacaoListComponent_th_101_Template, 2, 0, \"th\", 37)(102, TransacaoListComponent_td_102_Template, 2, 1, \"td\", 38);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(103, 45);\n            i0.ɵɵtemplate(104, TransacaoListComponent_th_104_Template, 2, 0, \"th\", 46)(105, TransacaoListComponent_td_105_Template, 11, 0, \"td\", 38);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵtemplate(106, TransacaoListComponent_tr_106_Template, 1, 0, \"tr\", 47)(107, TransacaoListComponent_tr_107_Template, 1, 0, \"tr\", 48)(108, TransacaoListComponent_tr_108_Template, 7, 2, \"tr\", 49);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(109, \"mat-paginator\", 50);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelement(110, \"app-footer\");\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            let tmp_6_0;\n            let tmp_7_0;\n            const exportMenu_r17 = i0.ɵɵreference(73);\n            i0.ɵɵadvance(16);\n            i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(17, 13, ctx.resumo.totalReceitas, \"BRL\"));\n            i0.ɵɵadvance(11);\n            i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(28, 16, ctx.resumo.totalDespesas, \"BRL\"));\n            i0.ɵɵadvance(11);\n            i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(39, 19, ctx.resumo.saldoTotal, \"BRL\"));\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"formGroup\", ctx.filterForm);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngIf\", ((tmp_6_0 = ctx.filterForm.get(\"tipoFiltro\")) == null ? null : tmp_6_0.value) === \"mes\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ((tmp_7_0 = ctx.filterForm.get(\"tipoFiltro\")) == null ? null : tmp_7_0.value) === \"periodo\");\n            i0.ɵɵadvance(19);\n            i0.ɵɵproperty(\"matMenuTriggerFor\", exportMenu_r17);\n            i0.ɵɵadvance(15);\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"dataSource\", ctx.dataSource);\n            i0.ɵɵadvance(22);\n            i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"pageSizeOptions\", i0.ɵɵpureFunction0(22, _c0))(\"pageSize\", 5);\n          }\n        },\n        dependencies: [i5.NgClass, i5.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName, i6.MatCard, i6.MatCardContent, i7.MatFormField, i7.MatLabel, i7.MatSuffix, i8.MatInput, i9.MatButton, i9.MatIconButton, i10.MatDatepicker, i10.MatDatepickerInput, i10.MatDatepickerToggle, i11.MatIcon, i12.MatPaginator, i13.MatMenu, i13.MatMenuItem, i13.MatMenuTrigger, i14.MatTable, i14.MatHeaderCellDef, i14.MatHeaderRowDef, i14.MatColumnDef, i14.MatCellDef, i14.MatRowDef, i14.MatHeaderCell, i14.MatCell, i14.MatHeaderRow, i14.MatRow, i14.MatNoDataRow, i15.MatSort, i15.MatSortHeader, i16.MatButtonToggleGroup, i16.MatButtonToggle, i17.MenuComponent, i18.FooterComponent, i5.CurrencyPipe, i5.DatePipe],\n        styles: [\"(()[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] >  {// webpackBootstrap \\\"use strict\\\";})()[_ngcontent-%COMP%] ;{%BLOCK%}\"]\n      });\n    }\n  }\n  return TransacaoListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}